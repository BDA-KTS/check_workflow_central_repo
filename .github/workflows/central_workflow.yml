name: Triggered Workflow

on:
  repository_dispatch:
jobs:
  handle-trigger:
    runs-on: ubuntu-latest

    steps:
      - name: Log event payload
        run: |
          echo "Received event payload:"
          echo "$GITHUB_EVENT_PATH"
          cat $GITHUB_EVENT_PATH

      - name: Get repository info from payload
        run: |
          # Extract repository name from the event payload
          REPO_NAME=$(jq -r '.repository.full_name' $GITHUB_EVENT_PATH)
          echo "Repository name: $REPO_NAME"

      - name: Checkout the repository from the payload
        run: |
          # Construct the repository URL
          REPO_URL="https://github.com/$REPO_NAME"
          echo "Checking out $REPO_URL"
          
          # Clone the repository
          git clone $REPO_URL
          cd $(basename $REPO_URL .git)  # Go into the cloned repo directory

      - name: Create 'Hello World' file in the 'report' directory
        run: |
          # Create 'report' directory if it doesn't exist
          mkdir -p report
          
          # Create the 'hello_world.txt' file with "Hello World"
          echo "Hello World" > report/hello_world.txt
          
          # Verify the file was created
          cat report/hello_world.txt

      - name: Commit and push changes
        run: |
          # Configure Git user details (required for commits)
          git config user.name "GitHub Actions"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          
          # Add changes to git, commit and push
          git add report/hello_world.txt
          git commit -m "Add Hello World file in report directory"
          git push origin main  # Or the relevant branch name (e.g., 'main' or 'master')
